
<h1 class="sectionedit1" id="需求">需求</h1>
<div class="level1">

<p>
由于全平台的产品线丰富，各应用都有支付的需求，而支付涉及一系列敏感密钥和流程，如支付宝、微信密钥key，支付创建订单、退款、查询订单、转账、对账、财务统计等。为了统一管理支付的所有密钥，节约其他应用程序开发时间及成本，有必要在平台内建立和完善支付网关或者支付中心应用。
</p>

<p>
目前涉及支付需求的应用有：想拍就拍（O2O项目）、商城系统、证件照等。
</p>

</div>
<!-- EDIT1 SECTION "需求" [1-522] -->
<h1 class="sectionedit2" id="概要设计">概要设计</h1>
<div class="level1">

</div>
<!-- EDIT2 SECTION "概要设计" [523-551] -->
<h2 class="sectionedit3" id="支付中心支付时序图">支付中心支付时序图</h2>
<div class="level2">

<p>
<a href="/doku.php?id=%E6%96%87%E4%BB%B6:%E6%94%AF%E4%BB%98%E4%B8%AD%E5%BF%83.jpg" class="wikilink2" title="文件:支付中心.jpg" rel="nofollow">支付中心.jpg</a>
</p>

</div>
<!-- EDIT3 SECTION "支付中心支付时序图" [552-620] -->
<h2 class="sectionedit4" id="支付宝支付时序图">支付宝支付时序图</h2>
<div class="level2">

<p>
<a href="/doku.php?id=%E6%96%87%E4%BB%B6:%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%AF%E4%BB%98.jpg" class="wikilink2" title="文件:支付宝支付.jpg" rel="nofollow">900px</a>
</p>

</div>
<!-- EDIT4 SECTION "支付宝支付时序图" [621-695] -->
<h2 class="sectionedit5" id="微信支付时序图">微信支付时序图</h2>
<div class="level2">

<p>
<a href="/doku.php?id=%E6%96%87%E4%BB%B6:%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98.jpg" class="wikilink2" title="文件:微信支付.jpg" rel="nofollow">900px</a>
</p>

</div>
<!-- EDIT5 SECTION "微信支付时序图" [696-764] -->
<h2 class="sectionedit6" id="第三方支付文档及sdk">第三方支付文档及SDK</h2>
<div class="level2">

<p>
支付宝移动支付
</p>

<p>
[<a href="http://pan.baidu.com/s/1bniASwR" class="urlextern" title="http://pan.baidu.com/s/1bniASwR"  rel="nofollow">http://pan.baidu.com/s/1bniASwR</a> 支付宝钱包支付接口开发包2.0标准版接入与使用规则]
</p>

<p>
[<a href="http://pan.baidu.com/s/1mg0904w" class="urlextern" title="http://pan.baidu.com/s/1mg0904w"  rel="nofollow">http://pan.baidu.com/s/1mg0904w</a> 支付宝钱包支付接口开发包2.0标准版]
</p>

<p>
支付宝移动支付SDK
</p>

<p>
[<a href="http://pan.baidu.com/s/1kTGkBFD" class="urlextern" title="http://pan.baidu.com/s/1kTGkBFD"  rel="nofollow">http://pan.baidu.com/s/1kTGkBFD</a> 支付宝钱包支付接口开发包2.0标准版(Android 3.0.1).zip]
</p>

<p>
[<a href="http://pan.baidu.com/s/1i31v7md" class="urlextern" title="http://pan.baidu.com/s/1i31v7md"  rel="nofollow">http://pan.baidu.com/s/1i31v7md</a> 支付宝钱包支付接口开发包2.0标准版(iOS 3.0.1).zip]
</p>

<p>
支付宝批量退款
</p>

<p>
[<a href="http://pan.baidu.com/s/1ntMmhyL" class="urlextern" title="http://pan.baidu.com/s/1ntMmhyL"  rel="nofollow">http://pan.baidu.com/s/1ntMmhyL</a> 即时到账批量退款有密接口(refund_fastpay_by_platform_pwd)接入与使用规则.pdf]
</p>

<p>
[<a href="http://pan.baidu.com/s/1mg8aZJa" class="urlextern" title="http://pan.baidu.com/s/1mg8aZJa"  rel="nofollow">http://pan.baidu.com/s/1mg8aZJa</a> 即时到账批量退款有密接口(refund_fastpay_by_platform_pwd).pdf]
</p>

<p>
[<a href="http://pan.baidu.com/s/1pJKkTEr" class="urlextern" title="http://pan.baidu.com/s/1pJKkTEr"  rel="nofollow">http://pan.baidu.com/s/1pJKkTEr</a> 即时到账批量退款无密接口(refund_fastpay_by_platform_nopwd)接入与使用规则.pdf]
</p>

<p>
[<a href="http://pan.baidu.com/s/1mgKrbs8" class="urlextern" title="http://pan.baidu.com/s/1mgKrbs8"  rel="nofollow">http://pan.baidu.com/s/1mgKrbs8</a> 即时到账批量退款无密接口(refund_fastpay_by_platform_nopwd).pdf]
</p>

<p>
支付宝订单支付查询
</p>

<p>
[<a href="http://pan.baidu.com/s/1i3vpSpR" class="urlextern" title="http://pan.baidu.com/s/1i3vpSpR"  rel="nofollow">http://pan.baidu.com/s/1i3vpSpR</a> 支付宝单笔支付查询接口(single_trade_query)1.2.pdf]
</p>

<p>
支付宝商家服务
</p>

<p>
[<a href="https://b.alipay.com/order/techService.htm" class="urlextern" title="https://b.alipay.com/order/techService.htm"  rel="nofollow">https://b.alipay.com/order/techService.htm</a> 支付宝商家服务]
</p>

<p>
支付宝技术支持
</p>

<p>
[<a href="https://cshall.alipay.com/support/cate_question.htm?cateId=239656&amp;pcateId=239544" class="urlextern" title="https://cshall.alipay.com/support/cate_question.htm?cateId=239656&amp;pcateId=239544"  rel="nofollow">https://cshall.alipay.com/support/cate_question.htm?cateId=239656&amp;pcateId=239544</a> 支付宝技术支持]
</p>

<p>
支付宝商户服务
</p>

<p>
[<a href="https://app.alipay.com/container/web/enterpriseIndex.htm" class="urlextern" title="https://app.alipay.com/container/web/enterpriseIndex.htm"  rel="nofollow">https://app.alipay.com/container/web/enterpriseIndex.htm</a> 支付宝商户服务]
</p>

<p>
微信：<a href="https://pay.weixin.qq.com/wiki/doc/api/app.php?chapter=11_1" class="urlextern" title="https://pay.weixin.qq.com/wiki/doc/api/app.php?chapter=11_1"  rel="nofollow">https://pay.weixin.qq.com/wiki/doc/api/app.php?chapter=11_1</a>
</p>

<p>
[<a href="https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=7_1" class="urlextern" title="https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=7_1"  rel="nofollow">https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=7_1</a> 微信公众号支付]
</p>

<p>
[<a href="http://pan.baidu.com/s/1mgq0eUW" class="urlextern" title="http://pan.baidu.com/s/1mgq0eUW"  rel="nofollow">http://pan.baidu.com/s/1mgq0eUW</a> 微信支付 wxpay-payment-api-v2.2.pdf]
</p>

<p>
[<a href="http://pan.baidu.com/s/1mgH42es" class="urlextern" title="http://pan.baidu.com/s/1mgH42es"  rel="nofollow">http://pan.baidu.com/s/1mgH42es</a> 微信支付 APP支付(IOS)接口文档V1.7.pdf]
</p>

<p>
[<a href="http://pan.baidu.com/s/1jGtRU3k" class="urlextern" title="http://pan.baidu.com/s/1jGtRU3k"  rel="nofollow">http://pan.baidu.com/s/1jGtRU3k</a> 微信支付 APP支付(Android)接口文档V1.7.pdf]
</p>

<p>
[<a href="http://pan.baidu.com/s/1gd0dHKn" class="urlextern" title="http://pan.baidu.com/s/1gd0dHKn"  rel="nofollow">http://pan.baidu.com/s/1gd0dHKn</a> 微信支付 APP支付(Android)接口文档V1.7.pdf]
</p>

</div>
<!-- EDIT6 SECTION "第三方支付文档及SDK" [765-2684] -->
<h2 class="sectionedit7" id="server_sdk接入说明">Server SDK接入说明</h2>
<div class="level2">

</div>
<!-- EDIT7 SECTION "Server SDK接入说明" [2685-2720] -->
<h2 class="sectionedit8" id="client_接入说明">Client 接入说明</h2>
<div class="level2">

</div>
<!-- EDIT8 SECTION "Client 接入说明" [2721-2753] -->
<h2 class="sectionedit9" id="关于渠道">关于渠道</h2>
<div class="level2">

</div>
<!-- EDIT9 SECTION "关于渠道" [2754-2779] -->
<h3 class="sectionedit10" id="微信公众号">微信公众号</h3>
<div class="level3">

<p>
微信公众账号支付，只能用于微信内置浏览器内，而且只有服务号才能申请该支付功能。发起微信公众号支付，首先需要在微信公众平台进行相关的开发配置，然后需要获取到open_id用于发起交易。
</p>

</div>

<h4 id="开发配置">开发配置</h4>
<div class="level4">

<p>
登陆微信公众平台 → 微信支付 → 开发配置，如：
</p>

<p>
<a href="/doku.php?id=%E6%96%87%E4%BB%B6:%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%BC%80%E5%8F%91%E9%85%8D%E7%BD%AE.jpg" class="wikilink2" title="文件:微信公众号微信支付开发配置.jpg" rel="nofollow">900px</a>
</p>

<p>
注意在测试授权目录下使用测试微信ID来进行测试
</p>

</div>

<h4 id="oauth20网页授权">OAuth2.0网页授权</h4>
<div class="level4">

<p>
登陆微信公众平台 → 开发者中心 → 网页服务 → 网页账号 → 修改，如：
</p>

<p>
<a href="/doku.php?id=%E6%96%87%E4%BB%B6:%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7oauth2.0.jpg" class="wikilink2" title="文件:微信公众号oauth2.0.jpg" rel="nofollow">600px</a>
</p>

</div>

<h4 id="js安全域名">JS安全域名</h4>
<div class="level4">

<p>
登陆微信公众平台 → 公众号设置 → 功能设置 → 设置，如： 
</p>

<p>
<a href="/doku.php?id=%E6%96%87%E4%BB%B6:js%E5%AE%89%E5%85%A8%E5%9F%9F%E5%90%8D.jpg" class="wikilink2" title="文件:js安全域名.jpg" rel="nofollow">600px</a>
</p>

</div>

<h4 id="获取openid">获取openid</h4>
<div class="level4">

<p>
要发起支付请求，需要额外的参数 open_id (微信公众号授权用户唯一标识)，如果仅仅只需要获取openid，请按以下步骤获取：
</p>

<p>
1.用户同意授权，获取code
</p>

<p>
<a href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=snsapi_base&amp;state=STATE#wechat_redirect" class="urlextern" title="https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=snsapi_base&amp;state=STATE#wechat_redirect"  rel="nofollow">https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=snsapi_base&amp;state=STATE#wechat_redirect</a>
</p>

<p>
APPID 为微信公众号appid
</p>

<p>
redirect_uri 授权后重定向的回调链接地址，请使用urlencode对链接进行处理 
</p>

<p>
response_type=code 返回类型，请填写code 
</p>

<p>
scope=snsapi_base 不弹出授权页面，直接跳转，只能获取用户openid
</p>

<p>
state=STATE 重定向后会带上state参数，开发者可以填写a-zA-Z0-9的参数值，最多128字节 
</p>

<p>
wechat_redirect 必须带此参数 
</p>

<p>
不弹出授权页面，页面将跳转至 redirect_uri/?code=CODE&amp;state=STATE。若用户禁止授权，则重定向后不会带上code参数，仅会带上state参数redirect_uri?state=STATE 
</p>

<p>
2.通过code换取网页授权access_token，同时获取到openid
</p>

<p>
<a href="https://api.weixin.qq.com/sns/oauth2/access_token?appid=APPID&amp;secret=SECRET&amp;code=CODE&amp;grant_type=authorization_code" class="urlextern" title="https://api.weixin.qq.com/sns/oauth2/access_token?appid=APPID&amp;secret=SECRET&amp;code=CODE&amp;grant_type=authorization_code"  rel="nofollow">https://api.weixin.qq.com/sns/oauth2/access_token?appid=APPID&amp;secret=SECRET&amp;code=CODE&amp;grant_type=authorization_code</a>
</p>

<p>
APPID 为微信公众号appid
</p>

<p>
secret 公众号的appsecret
</p>

<p>
code 填写第一步获取的code参数 
</p>

<p>
grant_type 填写为authorization_code
</p>

<p>
正确时返回的JSON数据包如下：
</p>

<p>
 {
</p>
<pre class="code"> &quot;access_token&quot;:&quot;ACCESS_TOKEN&quot;,
 &quot;expires_in&quot;:7200,
 &quot;refresh_token&quot;:&quot;REFRESH_TOKEN&quot;,
 &quot;openid&quot;:&quot;OPENID&quot;,
 &quot;scope&quot;:&quot;SCOPE&quot;,
 &quot;unionid&quot;: &quot;o6_bmasdasdsad6_2sgVt7hMZOPfL&quot;</pre>

<p>
 }
</p>

<p>
&lt;font color=“#FF0000”&gt;注意&lt;/font&gt;：由于公众号的secret和获取到的access_token安全级别都非常高，必须只保存在服务器，不允许传给客户端。后续刷新access_token、通过access_token获取用户信息等步骤，也必须从服务器发起。
</p>

</div>
<!-- EDIT10 SECTION "微信公众号" [2780-5416] -->
<h1 class="sectionedit11" id="技术选型">技术选型</h1>
<div class="level1">

</div>
<!-- EDIT11 SECTION "技术选型" [5417-5444] -->
<h2 class="sectionedit12" id="新技术调研">新技术调研</h2>
<div class="level2">

</div>
<!-- EDIT12 SECTION "新技术调研" [5445-5473] -->
<h3 class="sectionedit13" id="yii1的问题">Yii1的问题</h3>
<div class="level3">

<p>
#2008年正式发布，从时间上来看比较陈旧
#PHP语言特性限制在php-5.2，新的特性为了兼容php的低版本从而后续框架版本更新跟不上PHP语言本身的更新
#不同模块或者不同路径类名重复，即不支持命名空间
#代码规范不合理
</p>

</div>

<h4 id="升级到yii2">升级到Yii2</h4>
<div class="level4">

<p>
#完全拥抱Composer
#命名空间
#匿名函数
#数组短语法[…元素…] 用于取代 array(…元素…)
#视图文件中的短格式 echo 标签 &lt;?=，自 PHP 5.4 起总会被识别并且合法，无论 short_open_tag 的设置是什么，可以安全使用
#SPL类和接口
#延迟静态绑定
#Traits
#intl Yii 2.0 使用 PHP 扩展 intl 来支持国际化的相关功能
#代码更加规范
</p>

</div>
<!-- EDIT13 SECTION "Yii1的问题" [5474-6211] -->
<h3 class="sectionedit14" id="yii2文档">Yii2文档</h3>
<div class="level3">

</div>

<h4 id="yii_20_权威指南">Yii 2.0 权威指南</h4>
<div class="level4">

<p>
<a href="http://www.yiichina.com/doc/guide/2.0" class="urlextern" title="http://www.yiichina.com/doc/guide/2.0"  rel="nofollow">http://www.yiichina.com/doc/guide/2.0</a>
</p>

</div>

<h4 id="升级php-55">升级PHP-5.5</h4>
<div class="level4">

<p>
#从 PHP 5.3.X 迁移到 PHP 5.4.X <a href="http://php.net/manual/zh/migration54.php" class="urlextern" title="http://php.net/manual/zh/migration54.php"  rel="nofollow">http://php.net/manual/zh/migration54.php</a>
#从 PHP 5.4.x 迁移到 PHP 5.5.x <a href="http://php.net/manual/zh/migration55.php" class="urlextern" title="http://php.net/manual/zh/migration55.php"  rel="nofollow">http://php.net/manual/zh/migration55.php</a>
</p>

<p>
从现有的PHP-5.3升级PHP-5.5，新项目无升级成本。
</p>

</div>

<h4 id="composer">Composer</h4>
<div class="level4">

<p>
在后续的项目中慢慢的尝试通过Composer来管理PHP的依赖包
</p>

</div>

<h4 id="环境变量">环境变量</h4>
<div class="level4">

<p>
通过php-fpm配置文件提供的env指令来指定应用运行环境，通过getenv()来获取当前应用运行环境，理由：
</p>

<p>
#除研发同学自己的开发环境会通过docker，vagrant，一键环境安装包来部署环境外，其他服务器一旦采购就已经确定其用途，即手工配置一次php-fpm的env指令
#docker的开发环境可将php-fpm.conf的环境变量配置为development
#其思想是在PHP内部添加了一个配置项，就好比开发了一个扩展，扩展有一个运行时配置项来指定当前部署的环境
</p>

<p>
&lt;pre&gt;
&lt;?php
/**
 * 入口文件
 *
 * Camera360支付网关Paygw
 *
 * @author xudianyang@camera360.com
 * @copyright Chengdu pinguo Technology Co.,Ltd.
 */
$env    = getenv(&#039;environ&#039;) ? : &#039;product&#039;;
$config = require(<em class="u">DIR</em> . &#039;/../config/&#039; . $env . &#039;/web.php&#039;);
</p>

<p>
require(<em class="u">DIR</em> . &#039;/../vendor/autoload.php&#039;);
require(<em class="u">DIR</em> . &#039;/../vendor/yiisoft/yii2/Yii.php&#039;);
</p>

<p>
(new yii\web\Application($config))→run();
&lt;/pre&gt;
</p>

<p>
目前所有的项目至少有四套环境，development、newdev、product、testing，现有的做法是通过gethostname()来进行if else判断，代码臃肿，效率低下。
</p>

</div>
<!-- EDIT14 SECTION "Yii2文档" [6212-7819] -->
<h2 class="sectionedit15" id="mysql">MySQL</h2>
<div class="level2">

<p>
支付中心涉及的数据很敏感和重要，在操作过程中会有多种事务需求，选择MySQL作为数据库系统。
</p>

</div>
<!-- EDIT15 SECTION "MySQL" [7820-7968] -->
<h2 class="sectionedit16" id="rabbitmq">RabbitMQ</h2>
<div class="level2">

<p>
由于支付中心需要整合全公司的应用项目支付需求，故在收到第三方支付的异步通知消息时，消息入队后再出队。一期可以考虑透明传递第三方的通知。
</p>

</div>
<!-- EDIT16 SECTION "RabbitMQ" [7969-8193] -->
<h2 class="sectionedit17" id="日志">日志</h2>
<div class="level2">

<p>
其他应用系统和Paygw的交互，Paygw和第三方支付系统的交互过程中，一定要将原始请求的参数通过日志系统记录，便于排查定位问题。
</p>

</div>
<!-- EDIT17 SECTION "日志" [8194-8390] -->
<h1 class="sectionedit18" id="数据结构">数据结构</h1>
<div class="level1">

</div>
<!-- EDIT18 SECTION "数据结构" [8391-8418] -->
<h2 class="sectionedit19" id="商户表_biz">商户表（biz）</h2>
<div class="level2">
<pre class="code">CREATE TABLE `t_biz` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#039;自增ID&#039;,
  `name` varchar(128) DEFAULT &#039;&#039; COMMENT &#039;商户名称 &#039;,
  `desc` varchar(1000) DEFAULT &#039;&#039; COMMENT &#039;商户描述&#039;,
  `pp_sign_rsa_public_key` varchar(512) DEFAULT &#039;&#039; COMMENT &#039;商户业务系统公钥&#039;,
  `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#039;修改时间&#039;,
  `create_time` datetime NOT NULL COMMENT &#039;创建时间&#039;,
  `is_effect` tinyint(3) unsigned NOT NULL DEFAULT &#039;1&#039; COMMENT &#039;是否启用&#039;,
  `is_delete` tinyint(3) unsigned NOT NULL DEFAULT &#039;0&#039; COMMENT &#039;是否删除&#039;,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=&#039;商户数据表（包括配置的密钥）&#039;;</pre>

</div>
<!-- EDIT19 SECTION "商户表（biz）" [8419-9227] -->
<h2 class="sectionedit20" id="商户支付方式表_biz_pay">商户支付方式表（biz_pay）</h2>
<div class="level2">
<pre class="code">CREATE TABLE `t_biz_pay` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#039;自增ID&#039;,
  `biz_id` bigint(20) unsigned NOT NULL COMMENT &#039;商户ID&#039;,
  `way` tinyint(3) unsigned NOT NULL COMMENT &#039;支付方式&#039;,
  `name` varchar(128) DEFAULT &#039;&#039; COMMENT &#039;支付方式名称 &#039;,
  `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#039;修改时间&#039;,
  `create_time` datetime NOT NULL COMMENT &#039;创建时间&#039;,
  `keys` text NOT NULL COMMENT &#039;支付方式对应的密钥信息，json_encode结果&#039;,
  `is_effect` tinyint(3) unsigned NOT NULL DEFAULT &#039;1&#039; COMMENT &#039;是否启用&#039;,
  `is_delete` tinyint(3) unsigned NOT NULL DEFAULT &#039;0&#039; COMMENT &#039;是否删除&#039;,
  PRIMARY KEY (`id`),
  UNIQUE KEY `id_way` (`biz_id`,`way`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=&#039;商户支持的支付方式表&#039;;</pre>

</div>
<!-- EDIT20 SECTION "商户支付方式表（biz_pay）" [9228-10158] -->
<h2 class="sectionedit21" id="付款单表_pay">付款单表（pay）</h2>
<div class="level2">
<pre class="code">CREATE TABLE `t_pay` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#039;自增ID&#039;,
  `biz_id` bigint(20) unsigned NOT NULL COMMENT &#039;商户ID&#039;,
  `out_trade_no` varchar(32) NOT NULL COMMENT &#039;唯一交易号,如pp_1_15008295672657,pp_1是环境定义,之后是外部订单号&#039;,
  `trade_no` varchar(255) DEFAULT NULL COMMENT &#039;第三方支付提供的交易流水号&#039;,
  `way` tinyint(3) unsigned NOT NULL COMMENT &#039;支付方式,支付宝、微信等&#039;,
  `user_id` varchar(30) NOT NULL COMMENT &#039;用户ID&#039;,
  `user_name` varchar(100) DEFAULT NULL COMMENT &#039;用户名称&#039;,
  `status` tinyint(3) unsigned NOT NULL COMMENT &#039;支付状态&#039;,
  `total_fee` bigint(20) unsigned NOT NULL COMMENT &#039;总金额,单位为分&#039;,
  `expire_second` int(10) unsigned NOT NULL COMMENT &#039;经过多少秒后，订单过期&#039;,
  `client_ip` varchar(255) DEFAULT &#039;&#039; COMMENT &#039;目标用户ip&#039;,
  `currency` VARCHAR(20) DEFAULT &#039;CNY&#039; COMMENT &#039;支付币种&#039;,
  `subject` varchar(128) DEFAULT &#039;&#039; COMMENT &#039;订单标题 &#039;,
  `body` varchar(128) DEFAULT &#039;&#039; COMMENT &#039;订单正文&#039;,
  `buyer_info` varchar(2048) DEFAULT NULL COMMENT &#039;买家信息,没有固定格式,由对应的支付方式设置和转换&#039;,
  `create_time` datetime NOT NULL COMMENT &#039;支付创建时间&#039;,
  `start_time` datetime NOT NULL COMMENT &#039;开始付款时间&#039;,
  `pay_time` datetime DEFAULT NULL COMMENT &#039;支付成功时间&#039;,
  `update_time` datetime NOT NULL COMMENT &#039;修改时间&#039;,
  `addinfo` text COMMENT &#039;附件字段信息&#039;,
  `refund_amount` bigint(20) DEFAULT NULL COMMENT &#039;已退款金额&#039;,
  `is_effect` tinyint(3) unsigned NOT NULL DEFAULT &#039;1&#039; COMMENT &#039;是否启用&#039;,
  `is_delete` tinyint(3) unsigned NOT NULL DEFAULT &#039;0&#039; COMMENT &#039;是否删除&#039;,
  PRIMARY KEY (`id`),
  UNIQUE KEY `payid` (`pay_id`),
  UNIQUE KEY `biz_id_out_tradeno_way` (`biz_id`, `out_trade_no`,`way`),
  KEY `trade_no` (`trade_no`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=&#039;付款单表&#039;;</pre>

</div>
<!-- EDIT21 SECTION "付款单表（pay）" [10159-12187] -->
<h2 class="sectionedit22" id="支付请求和响应日志表_biz_log">支付请求和响应日志表（biz_log）</h2>
<div class="level2">
<pre class="code">CREATE TABLE `t_biz_log` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#039;自增ID&#039;,
  `out_trade_no` varchar(30) NOT NULL COMMENT &#039;唯一交易号,如pp_1_15008295672657,pp_1是环境定义,之后是外部订单号&#039;,
  `type` VARCHAR(512) DEFAULT &#039;&#039; COMMENT &#039;请求类型&#039;,
  `request_time` datetime NOT NULL COMMENT &#039;请求时间&#039;,
  `response_time` datetime NULL COMMENT &#039;响应时间&#039;,
  `request` text NOT NULL COMMENT &#039;原始请求参数&#039;,
  `response` text DEFAULT NULL COMMENT &#039;响应参数&#039;,
  `is_effect` tinyint(3) unsigned NOT NULL DEFAULT &#039;1&#039; COMMENT &#039;是否启用&#039;,
  `is_delete` tinyint(3) unsigned NOT NULL DEFAULT &#039;0&#039; COMMENT &#039;是否删除&#039;,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=&#039;支付请求和响应日志表（创建、退款、转账、查询等）&#039;;</pre>

</div>
<!-- EDIT22 SECTION "支付请求和响应日志表（biz_log）" [12188-13100] -->
<h2 class="sectionedit23" id="第三方支付异步通知日志表_third_part_log">第三方支付异步通知日志表（third_part_log）</h2>
<div class="level2">
<pre class="code">CREATE TABLE `t_third_part_log` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#039;自增ID&#039;,
  `out_trade_no` varchar(30) NOT NULL COMMENT &#039;唯一交易号,如pp_1_15008295672657,pp_1是环境定义,之后是外部订单号&#039;,
  `notify_type` varchar(100) DEFAULT &#039;&#039; COMMENT &#039;异步通知类型&#039;,
  `buyer_info` varchar(2048) DEFAULT NULL COMMENT &#039;买家信息,没有固定格式,由对应的支付方式设置和转换&#039;,
  `trade_no` varchar(255) DEFAULT NULL COMMENT &#039;第三方支付提供的交易流水号&#039;,
  `request_time` datetime NOT NULL COMMENT &#039;请求时间&#039;,
  `response_time` datetime NULL COMMENT &#039;响应时间&#039;,
  `request` text NOT NULL COMMENT &#039;原始通知数据&#039;,
  `response` text DEFAULT NULL COMMENT &#039;响应参数&#039;,
  `is_effect` tinyint(3) unsigned NOT NULL DEFAULT &#039;1&#039; COMMENT &#039;是否启用&#039;,
  `is_delete` tinyint(3) unsigned NOT NULL DEFAULT &#039;0&#039; COMMENT &#039;是否删除&#039;,
  PRIMARY KEY (`id`),
  KEY `out_trade_no` (`out_trade_no`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=&#039;第三方支付请求和响应日志表&#039;;</pre>

</div>
<!-- EDIT23 SECTION "第三方支付异步通知日志表（third_part_log）" [13101-14273] -->
<h2 class="sectionedit24" id="异步通知业务方反馈表_notify_feedback">异步通知业务方反馈表（notify_feedback）</h2>
<div class="level2">
<pre class="code">CREATE TABLE `t_notify_feedback` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#039;自增ID&#039;,
  `biz_id` bigint(20) unsigned NOT NULL COMMENT &#039;商户ID&#039;,
  `out_trade_no` varchar(30) NOT NULL COMMENT &#039;唯一交易号,如pp_1_15008295672657,pp_1是环境定义,之后是外部订单号&#039;,
  `way` tinyint(3) unsigned NOT NULL COMMENT &#039;支付方式,支付宝、微信等&#039;,
  `notify_type` varchar(100) NOT NULL COMMENT &#039;异步通知类型&#039;,
  `trade_no` varchar(255) NOT NULL COMMENT &#039;第三方支付提供的交易流水号&#039;,
  `create_time` datetime NOT NULL COMMENT &#039;通知创建时间&#039;,
  `update_time` datetime DEFAULT NULL COMMENT &#039;更新时间&#039;,
  `notify_content` text NOT NULL COMMENT &#039;原始通知数据&#039;,
  `feedback` text DEFAULT NULL COMMENT &#039;反馈数据&#039;,
  `is_effect` tinyint(3) unsigned NOT NULL DEFAULT &#039;1&#039; COMMENT &#039;是否启用&#039;,
  `is_delete` tinyint(3) unsigned NOT NULL DEFAULT &#039;0&#039; COMMENT &#039;是否删除&#039;,
  PRIMARY KEY (`id`),
  KEY `out_trade_no` (`out_trade_no`),
  KEY `biz_id_out_trade_no_way` (`biz_id`, `out_trade_no`, `way`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=&#039;异步通知业务方反馈表（包括支付异步通知,退款异步通知,转账异步通知等）&#039;;</pre>

</div>
<!-- EDIT24 SECTION "异步通知业务方反馈表（notify_feedback）" [14274-15604] -->
<h2 class="sectionedit25" id="退款记录表_refund">退款记录表（refund）</h2>
<div class="level2">
<pre class="code">CREATE TABLE `t_refund` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#039;自增ID&#039;,
  `biz_id` bigint(20) unsigned NOT NULL COMMENT &#039;商户ID&#039;,
  `user_id` varchar(30) NOT NULL COMMENT &#039;用户ID&#039;,
  `out_trade_no` varchar(30) NOT NULL COMMENT &#039;唯一交易号,如pp_1_15008295672657,pp_1是环境定义,之后是外部订单号&#039;,
  `out_refund_no` varchar(30) NOT NULL COMMENT &#039;外部退款单号,如pp_1_15008295672657,pp_1是环境定义,之后是外部退款单号&#039;,
  `trade_no` varchar(255) DEFAULT NULL COMMENT &#039;第三方支付提供的交易流水号&#039;,
  `user_name` varchar(30) NOT NULL COMMENT &#039;用户名&#039;,
  `status` tinyint(3) unsigned NOT NULL COMMENT &#039;退款状态&#039;,
  `refund_fee` bigint(20) unsigned NOT NULL COMMENT &#039;退款总金额,单位为分&#039;,
  `total_fee` varchar(45) DEFAULT NULL,
  `way` tinyint(3) unsigned NOT NULL COMMENT &#039;支付方式&#039;,
  `reason` varchar(45) NOT NULL,
  `refund_time` datetime DEFAULT NULL COMMENT &#039;退款成功时间&#039;,
  `update_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#039;修改时间&#039;,
  `create_time` datetime NOT NULL COMMENT &#039;退款创建时间&#039;,
  `is_delete` tinyint(3) unsigned NOT NULL DEFAULT &#039;0&#039; COMMENT &#039;是否删除&#039;,
  `is_effect` tinyint(3) unsigned NOT NULL DEFAULT &#039;1&#039; COMMENT &#039;是否启用&#039;,
  PRIMARY KEY (`id`),
  UNIQUE KEY `refundid` (`refund_id`),
  UNIQUE KEY `out_refund_no` (`out_refund_no`),
  KEY `trade_no` (`trade_no`),
  KEY `biz_id_out_trade_no_way` (`biz_id`, `out_trade_no`, `way`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=&#039;退款记录表&#039;;</pre>

</div>
<!-- EDIT25 SECTION "退款记录表（refund）" [15605-17294] -->
<h2 class="sectionedit26" id="退款批次表_refund_batch">退款批次表（refund_batch）</h2>
<div class="level2">
<pre class="code">CREATE TABLE `t_refund_batch` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#039;自增ID&#039;,
  `biz_id` bigint(20) unsigned NOT NULL COMMENT &#039;商户ID&#039;,
  `batch_no` bigint(32) unsigned NOT NULL COMMENT &#039;退款批次号&#039;,
  `batch_num` smallint(3) unsigned NOT NULL COMMENT &#039;退款批次数&#039;,
  `detail_data` text NOT NULL COMMENT &#039;详细数据&#039;,
  `refund_date` datetime NOT NULL COMMENT &#039;请求的退款时间&#039;,
  `is_effect` tinyint(3) unsigned NOT NULL DEFAULT &#039;1&#039; COMMENT &#039;是否启用&#039;,
  `is_delete` tinyint(3) unsigned NOT NULL DEFAULT &#039;0&#039; COMMENT &#039;是否删除&#039;,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=&#039;退款批次表&#039;;</pre>

</div>
<!-- EDIT26 SECTION "退款批次表（refund_batch）" [17295-18047] -->
<h1 class="sectionedit27" id="系统交互">系统交互</h1>
<div class="level1">

</div>
<!-- EDIT27 SECTION "系统交互" [18048-18076] -->
<h2 class="sectionedit28" id="协议">协议</h2>
<div class="level2">

<p>
HTTPS POST
</p>

</div>
<!-- EDIT28 SECTION "协议" [18077-18108] -->
<h2 class="sectionedit29" id="数据格式">数据格式</h2>
<div class="level2">

<p>
JSON
</p>

</div>
<!-- EDIT29 SECTION "数据格式" [18109-18140] -->
<h2 class="sectionedit30" id="签名">签名</h2>
<div class="level2">

</div>
<!-- EDIT30 SECTION "签名" [18141-18160] -->
<h3 class="sectionedit31" id="待签名数据集">待签名数据集</h3>
<div class="level3">

<p>
待签名数据集是一个键值对集合
</p>

</div>

<h4 id="待签名字符串生成方式">待签名字符串生成方式</h4>
<div class="level4">

<p>
由待签名数据集的键值对，按照key=value的形式拼接，然后按照字母序排序成一个字符串数组，用字符&#039;&amp;&#039;来连接这个数组，得到的字符串作为待签名字符串。
</p>

</div>

<h4 id="rsa签名方式">RSA签名方式</h4>
<div class="level4">

<p>
签名方式：得到待签名字符串后，用私钥签名，得到的结果就是签名结果。
</p>

<p>
验签方式：得到待签名字符串后，用公钥验证给出的签名是否正确。
</p>

</div>

<h4 id="签名使用">签名使用</h4>
<div class="level4">

<p>
{| border=1
</p>
<div class="table sectionedit32"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT32 TABLE [18733-18735] -->
<p>
!应用场景!!签名方!!验签方!!签名方式!!待签名数据集!!验证结果!!签名数据!!验签数据
</p>
<div class="table sectionedit33"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td><td class="col10"></td><td class="col11"></td><td class="col12"></td><td class="col13"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">api/pay/create请求参数防伪</td><td class="col2" colspan="2">其他应用</td><td class="col4" colspan="2">paygw</td><td class="col6" colspan="2">RSA</td><td class="col8" colspan="2">请求的POST参数中除pp_sign和pp_sign_type之外的所有参数</td><td class="col10" colspan="2">pp_sign</td><td class="col12" colspan="2">其他应用私钥</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td><td class="col10"></td><td class="col11"></td><td class="col12"></td><td class="col13"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">api/pay/create返回参数防伪</td><td class="col2" colspan="2">paygw</td><td class="col4" colspan="2">其他应用</td><td class="col6" colspan="2">RSA</td><td class="col8" colspan="2">返回数据中除pp_sign和pp_sign_type之外的所有参数</td><td class="col10" colspan="2">pp_sign</td><td class="col12" colspan="2">paygw支付私钥</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td><td class="col10"></td><td class="col11"></td><td class="col12"></td><td class="col13"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">api/pay/query请求参数防伪</td><td class="col2" colspan="2">其他应用</td><td class="col4" colspan="2">paygw</td><td class="col6" colspan="2">RSA</td><td class="col8" colspan="2">请求的POST参数中除pp_sign和pp_sign_type之外的所有参数</td><td class="col10" colspan="2">pp_sign</td><td class="col12" colspan="2">其他应用私钥</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td><td class="col10"></td><td class="col11"></td><td class="col12"></td><td class="col13"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">api/pay/query返回参数防伪</td><td class="col2" colspan="2">paygw</td><td class="col4" colspan="2">其他应用</td><td class="col6" colspan="2">RSA</td><td class="col8" colspan="2">返回数据中除pp_sign和pp_sign_type之外的所有参数</td><td class="col10" colspan="2">pp_sign</td><td class="col12" colspan="2">paygw支付私钥</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td><td class="col10"></td><td class="col11"></td><td class="col12"></td><td class="col13"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">api/refund/create请求参数防伪</td><td class="col2" colspan="2">其他应用</td><td class="col4" colspan="2">paygw</td><td class="col6" colspan="2">RSA</td><td class="col8" colspan="2">请求的POST参数中除pp_sign和pp_sign_type之外的所有参数</td><td class="col10" colspan="2">pp_sign</td><td class="col12" colspan="2">其他应用私钥</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td><td class="col10"></td><td class="col11"></td><td class="col12"></td><td class="col13"></td>
	</tr>
	<tr class="row11">
		<td class="col0" colspan="2">api/refund/create返回参数防伪</td><td class="col2" colspan="2">paygw</td><td class="col4" colspan="2">其他应用</td><td class="col6" colspan="2">RSA</td><td class="col8" colspan="2">返回数据中除pp_sign和pp_sign_type之外的所有参数</td><td class="col10" colspan="2">pp_sign</td><td class="col12" colspan="2">paygw支付私钥</td>
	</tr>
	<tr class="row12">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td><td class="col10"></td><td class="col11"></td><td class="col12"></td><td class="col13"></td>
	</tr>
	<tr class="row13">
		<td class="col0" colspan="2">api/pay/notify返回参数防伪</td><td class="col2" colspan="2">paygw</td><td class="col4" colspan="2">其他应用</td><td class="col6" colspan="2">RSA</td><td class="col8" colspan="2">返回数据中除pp_sign和pp_sign_type之外的所有参数</td><td class="col10" colspan="2">pp_sign</td><td class="col12" colspan="2">paygw支付私钥</td>
	</tr>
	<tr class="row14">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td><td class="col10"></td><td class="col11"></td><td class="col12"></td><td class="col13"></td>
	</tr>
</table></div>
<!-- EDIT33 TABLE [18848-20092] -->
</div>

<h4 id="paygw公钥">Paygw公钥</h4>
<div class="level4">

<p>
&lt;pre&gt;
—–BEGIN PUBLIC KEY—–
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDgJqx9mv2y4N0hEFHSnke/VavI
sLndZRQxNedjIs+VP5k5XQNyqvRaZBGPgw/xolWmKd1+htlwuiJ3mNRUuJAURbFN
DOONqlWXtDa7Uzf5G4dRqa+ZhUOofb4mGF/aR4ucyXVY4IXm6+cmDbrTxoeyc71a
8AbcCDGLtH/suXOykwIDAQAB
—–END PUBLIC KEY—–
&lt;/pre&gt;
</p>

</div>
<!-- EDIT31 SECTION "待签名数据集" [18161-20400] -->
<h1 class="sectionedit34" id="代码">代码</h1>
<div class="level1">

</div>
<!-- EDIT34 SECTION "代码" [20401-20422] -->
<h2 class="sectionedit35" id="git">GIT</h2>
<div class="level2">

<p>
<a href="https://github.com/PGWireless/Paygw" class="urlextern" title="https://github.com/PGWireless/Paygw"  rel="nofollow">https://github.com/PGWireless/Paygw</a>
</p>

</div>
<!-- EDIT35 SECTION "GIT" [20423-20476] -->
<h3 class="sectionedit36" id="部署">部署</h3>
<div class="level3">

</div>

<h4 id="php-55">PHP-5.5</h4>
<div class="level4">

</div>

<h4 id="安装composer">安装Composer</h4>
<div class="level4">
<pre class="code">&gt;curl -sS https://getcomposer.org/installer | php</pre>

</div>

<h4 id="安装paygw依赖包">安装paygw依赖包</h4>
<div class="level4">
<pre class="code">&gt;cd paygw
&gt;composer install</pre>

</div>
<!-- EDIT36 SECTION "部署" [20477-20651] -->
<h1 class="sectionedit37" id="部署结构">部署结构</h1>
<div class="level1">

<p>
<a href="/doku.php?id=%E6%96%87%E4%BB%B6:camer360%E6%94%AF%E4%BB%98%E7%BD%91%E5%85%B3.jpg" class="wikilink2" title="文件:camer360支付网关.jpg" rel="nofollow">Camer360支付网关.jpg</a>
</p>

</div>
<!-- EDIT37 SECTION "部署结构" [20652-20716] -->
<h1 class="sectionedit38" id="监控">监控</h1>
<div class="level1">

</div>
<!-- EDIT38 SECTION "监控" [20717-20738] -->
<h2 class="sectionedit39" id="与其他业务系统网络通信状况监控">与其他业务系统网络通信状况监控</h2>
<div class="level2">

<p>
由于支付网关接收了第三方支付系统的异步通知后，再通知其他业务系统，如果支付网关和其他业务系统在不同的机房，有可能网络通信不畅，或者丢包严重，需要及时通知业务系统相关负责人处理。
</p>

</div>
<!-- EDIT39 SECTION "与其他业务系统网络通信状况监控" [20739-21063] -->
<h3 class="sectionedit40" id="盟宝游戏">盟宝游戏</h3>
<div class="level3">

<p>
url：<a href="http://api.pay.cloud.linnyou.com/pay/notifyOrder" class="urlextern" title="http://api.pay.cloud.linnyou.com/pay/notifyOrder"  rel="nofollow">http://api.pay.cloud.linnyou.com/pay/notifyOrder</a>
</p>

<p>
预期响应：fail
</p>

<p>
监控：每隔20s访问一次，连接3次访问失败告警。
</p>

</div>
<!-- EDIT40 SECTION "盟宝游戏" [21064-21230] -->
<h3 class="sectionedit41" id="想拍就拍">想拍就拍</h3>
<div class="level3">

<p>
url：<a href="https://photobazaar.camera360.com/photoBazaar/payCallBack" class="urlextern" title="https://photobazaar.camera360.com/photoBazaar/payCallBack"  rel="nofollow">https://photobazaar.camera360.com/photoBazaar/payCallBack</a>
</p>

<p>
预期响应：{“data”:[],“status”:401,“message”:“out_trade_no is required!”,“serverTime”:1448355996.0754}
</p>

<p>
监控：每隔20s访问一次，连接3次访问失败告警。
</p>

<p>
备注：serverTime每次请求可能不一样。
</p>

</div>
<!-- EDIT41 SECTION "想拍就拍" [21231-21544] -->
<h2 class="sectionedit42" id="错误日志监控">错误日志监控</h2>
<div class="level2">

<p>
支付网关采用了Yii2，为了输出符合品果规范的日志，并对接日志系统，封装了基于Yii2 log组件的PG\log类库。
</p>

<p>
日志级别：info,trace,notice,profile,warning,error
</p>

<p>
日志规范：[<a href="http://wiki.pinguo.us:8011/index.php?title=" class="urlextern" title="http://wiki.pinguo.us:8011/index.php?title="  rel="nofollow">http://wiki.pinguo.us:8011/index.php?title=</a>应用日志规范 应用日志规范]
</p>

<p>
监控：产生error,warning就应该报警。
</p>

</div>
<!-- EDIT42 SECTION "错误日志监控" [21545-21922] -->
<h1 class="sectionedit43" id="支付api">支付API</h1>
<div class="level1">

</div>
<!-- EDIT43 SECTION "支付API" [21923-21947] -->
<h2 class="sectionedit44" id="支付方式_way">支付方式（way）</h2>
<div class="level2">

<p>
{| border=1
</p>
<div class="table sectionedit45"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT45 TABLE [21994-21996] -->
<p>
!方式!!值
</p>
<div class="table sectionedit46"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">支付宝移动快捷支付</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">微信APP支付</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">微信公众号</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td>
	</tr>
</table></div>
<!-- EDIT46 TABLE [22010-22099] -->
</div>
<!-- EDIT44 SECTION "支付方式（way）" [21948-22100] -->
<h2 class="sectionedit47" id="商户_biz_id">商户（biz_id）</h2>
<div class="level2">

<p>
通过在Paygw后台添加商户后返回，如：
</p>

<p>
{| border=1
</p>
<div class="table sectionedit48"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT48 TABLE [22196-22198] -->
<p>
!名称!!值
</p>
<div class="table sectionedit49"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">商城正式环境</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">商城开发测试</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">商城QA测试</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">想拍就拍正式环境</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">想拍就拍开发测试</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row11">
		<td class="col0" colspan="2">想拍就拍QA测试</td>
	</tr>
	<tr class="row12">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row13">
		<td class="col0" colspan="2">盟宝正式环境</td>
	</tr>
	<tr class="row14">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row15">
		<td class="col0" colspan="2">盟宝开发测试</td>
	</tr>
	<tr class="row16">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row17">
		<td class="col0" colspan="2">盟宝QA测试</td>
	</tr>
	<tr class="row18">
		<td class="col0"></td><td class="col1"></td>
	</tr>
</table></div>
<!-- EDIT49 TABLE [22212-22454] -->
</div>
<!-- EDIT47 SECTION "商户（biz_id）" [22101-22455] -->
<h2 class="sectionedit50" id="支付订单状态_trade_status">支付订单状态（trade_status）</h2>
<div class="level2">

<p>
{| border=1
</p>
<div class="table sectionedit51"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT51 TABLE [22516-22518] -->
<p>
!状态!!值
</p>
<div class="table sectionedit52"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">未支付</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">已支付</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">已支付不可退款</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">交易不存在（第三方支付系统中）</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">未知状态</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td>
	</tr>
</table></div>
<!-- EDIT52 TABLE [22532-22680] -->
</div>
<!-- EDIT50 SECTION "支付订单状态（trade_status）" [22456-22681] -->
<h2 class="sectionedit53" id="退款订单状态_refund_status">退款订单状态（refund_status）</h2>
<div class="level2">

<p>
{| border=1
</p>
<div class="table sectionedit54"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT54 TABLE [22743-22745] -->
<p>
!状态!!值
</p>
<div class="table sectionedit55"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">待处理</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">已处理</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">退款失败</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">退款成功</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">无退款</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td>
	</tr>
	<tr class="row11">
		<td class="col0" colspan="2">未知状态</td>
	</tr>
	<tr class="row12">
		<td class="col0"></td><td class="col1"></td>
	</tr>
</table></div>
<!-- EDIT55 TABLE [22759-22884] -->
<p>
备注：
</p>

<p>
支付宝退款需要批量申请去支付宝执行
</p>

<p>
银行卡退款成功通知会很慢，1~3天左右，微信零钱支付的的退款结果在同步通知中已更新
</p>

</div>
<!-- EDIT53 SECTION "退款订单状态（refund_status）" [22682-23068] -->
<h2 class="sectionedit56" id="创建支付订单">创建支付订单</h2>
<div class="level2">

</div>
<!-- EDIT56 SECTION "创建支付订单" [23069-23100] -->
<h3 class="sectionedit57" id="历史">历史</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit58"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT58 TABLE [23131-23133] -->
<p>
!版本!!日期!!作者!!内容
</p>
<div class="table sectionedit59"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">1</td><td class="col2" colspan="2">2015-09-12</td><td class="col4" colspan="2">徐典阳</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
</table></div>
<!-- EDIT59 TABLE [23166-23205] -->
</div>
<!-- EDIT57 SECTION "历史" [23101-23206] -->
<h3 class="sectionedit60" id="url">URL</h3>
<div class="level3">

<p>
<a href="https://paygw.camera360.com/api/pay/create" class="urlextern" title="https://paygw.camera360.com/api/pay/create"  rel="nofollow">https://paygw.camera360.com/api/pay/create</a>
</p>

</div>
<!-- EDIT60 SECTION "URL" [23207-23264] -->
<h3 class="sectionedit61" id="参数">参数</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit62"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT62 TABLE [23295-23297] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit63"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">biz_id</td><td class="col2" colspan="2">商户ID</td><td class="col4" colspan="2">见商户（biz_id）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">way</td><td class="col2" colspan="2">支付方式</td><td class="col4" colspan="2">见支付方式（way）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">out_trade_no</td><td class="col2" colspan="4">外部订单号</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">subject</td><td class="col2" colspan="2">订单标题</td><td class="col4" colspan="2">长度限制128字节，不超过42个汉字。</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">body</td><td class="col2" colspan="2">订单正文</td><td class="col4" colspan="2">长度限制255字节</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row11">
		<td class="col0" colspan="2">total_fee</td><td class="col2" colspan="2">支付金额</td><td class="col4" colspan="2">大于0，单位为分</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row12">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row13">
		<td class="col0" colspan="2">expire_second</td><td class="col2" colspan="2">订单过期时间</td><td class="col4" colspan="2">相对当前时间，单位秒</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row14">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row15">
		<td class="col0" colspan="2">user_id</td><td class="col2" colspan="4">用户ID</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row16">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row17">
		<td class="col0" colspan="2">user_name</td><td class="col2" colspan="4">用户名称</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row18">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row19">
		<td class="col0" colspan="2">client_ip</td><td class="col2" colspan="4">实际支付IP</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row20">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row21">
		<td class="col0" colspan="2">openid</td><td class="col2" colspan="2">微信openid</td><td class="col4" colspan="2">微信公众号支付时获取的openid，仅在微信公众号支付时传递</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row22">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row23">
		<td class="col0" colspan="2">pp_sign</td><td class="col2" colspan="2">签名</td><td class="col4" colspan="2">由业务方用私钥加密生成</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row24">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row25">
		<td class="col0" colspan="2">pp_sign_type</td><td class="col2" colspan="2">签名方式</td><td class="col4" colspan="2">暂时只能为RSA</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row26">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT63 TABLE [23352-24205] -->
</div>
<!-- EDIT61 SECTION "参数" [23265-24206] -->
<h3 class="sectionedit64" id="返回">返回</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit65"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT65 TABLE [24237-24239] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit66"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">errno</td><td class="col2" colspan="2">错误码</td><td class="col4" colspan="2">见错误码（errno）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">message</td><td class="col2" colspan="2">错误描述</td><td class="col4" colspan="2">见错误描述（message）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">data</td><td class="col2" colspan="4">业务数据</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT66 TABLE [24294-24459] -->
<p>
成功时data字段说明
</p>

<p>
{| border=1
</p>
<div class="table sectionedit67"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT67 TABLE [24500-24502] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit68"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">sdk</td><td class="col2" colspan="2">调用支付sdk所需参数</td><td class="col4" colspan="2">微信包含appid，noncestr，package，partnerid，prepayid，timestamp，sign字段；支付宝移动快捷支付包含order_info，sign，sign_type</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">trade</td><td class="col2" colspan="2">交易相关信息</td><td class="col4" colspan="2">包含way，call_back_url，pp_sign，pp_sign_type等等</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT68 TABLE [24557-24867] -->
<p>
 注：支付宝移动快捷方式 服务端拿到返回结构需要 将sign,sign_type 放入order_info元素中 再返回给客户端唤起支付;
</p>

</div>
<!-- EDIT64 SECTION "返回" [24207-25016] -->
<h2 class="sectionedit69" id="支付异步通知">支付异步通知</h2>
<div class="level2">

<p>
整合微信/支付宝的等所有第三方的异步通知，合并成同构的异步通知转发给其他应用系统。其他应用系统需要为paygw提供一个处理异步通知的url。在校验过参数后并处理完关键逻辑后，返回success
</p>

</div>
<!-- EDIT69 SECTION "支付异步通知" [25017-25306] -->
<h3 class="sectionedit70" id="历史1">历史</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit71"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT71 TABLE [25337-25339] -->
<p>
!版本!!日期!!作者!!内容
</p>
<div class="table sectionedit72"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">1</td><td class="col2" colspan="2">2015-09-12</td><td class="col4" colspan="2">徐典阳</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
</table></div>
<!-- EDIT72 TABLE [25372-25411] -->
</div>
<!-- EDIT70 SECTION "历史" [25307-25412] -->
<h3 class="sectionedit73" id="参数1">参数</h3>
<div class="level3">

<p>
paygw收到第三方异步通知后，参数都以POST方式传递，参数列表如下：
</p>

<p>
{| border=1
</p>
<div class="table sectionedit74"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT74 TABLE [25534-25536] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit75"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">notify_id</td><td class="col2" colspan="2">通知ID</td><td class="col4" colspan="2">通知唯一标示</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">notify_type</td><td class="col2" colspan="2">通知类型</td><td class="col4" colspan="2">支付异步通知：trade_status_sync</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">notify_time</td><td class="col2" colspan="2">通知时间</td><td class="col4" colspan="2">格式为【yyyy-MM-dd HH:mm:ss】 </td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">biz_id</td><td class="col2" colspan="2">商户ID</td><td class="col4" colspan="2">见商户（biz_id）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">way</td><td class="col2" colspan="2">支付方式</td><td class="col4" colspan="2">见支付方式（way）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row11">
		<td class="col0" colspan="2">trade_no</td><td class="col2" colspan="2">支付流水号</td><td class="col4" colspan="2">支付宝对应trade_no，微信对应transaction_id</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row12">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row13">
		<td class="col0" colspan="2">trade_status</td><td class="col2" colspan="2">支付订单状态</td><td class="col4" colspan="2">见支付订单状（trade_status）</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row14">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row15">
		<td class="col0" colspan="2">pay_time</td><td class="col2" colspan="2">支付时间</td><td class="col4" colspan="2">格式为【yyyy-MM-dd HH:mm:ss】</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row16">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row17">
		<td class="col0" colspan="2">out_trade_no</td><td class="col2" colspan="4">外部订单号</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row18">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row19">
		<td class="col0" colspan="2">total_fee</td><td class="col2" colspan="2">支付金额</td><td class="col4" colspan="2">大于0，单位为分</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row20">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row21">
		<td class="col0" colspan="2">user_id</td><td class="col2" colspan="4">用户ID</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row22">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row23">
		<td class="col0" colspan="2">user_name</td><td class="col2" colspan="4">用户名称</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row24">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row25">
		<td class="col0" colspan="2">pp_sign</td><td class="col2" colspan="2">签名</td><td class="col4" colspan="2">由业务方用私钥加密生成</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row26">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row27">
		<td class="col0" colspan="2">pp_sign_type</td><td class="col2" colspan="2">签名方式</td><td class="col4" colspan="2">暂时只能为RSA</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row28">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT75 TABLE [25591-26534] -->
</div>
<!-- EDIT73 SECTION "参数" [25413-26535] -->
<h2 class="sectionedit76" id="退款">退款</h2>
<div class="level2">

</div>
<!-- EDIT76 SECTION "退款" [26536-26555] -->
<h3 class="sectionedit77" id="历史2">历史</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit78"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT78 TABLE [26586-26588] -->
<p>
!版本!!日期!!作者!!内容
</p>
<div class="table sectionedit79"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">1</td><td class="col2" colspan="2">2015-09-12</td><td class="col4" colspan="2">徐典阳</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
</table></div>
<!-- EDIT79 TABLE [26621-26660] -->
</div>
<!-- EDIT77 SECTION "历史" [26556-26661] -->
<h3 class="sectionedit80" id="url1">URL</h3>
<div class="level3">

<p>
<a href="https://paygw.camera360.com/api/refund/create" class="urlextern" title="https://paygw.camera360.com/api/refund/create"  rel="nofollow">https://paygw.camera360.com/api/refund/create</a>
</p>

</div>
<!-- EDIT80 SECTION "URL" [26662-26722] -->
<h3 class="sectionedit81" id="参数2">参数</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit82"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT82 TABLE [26753-26755] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit83"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">way</td><td class="col2" colspan="2">支付方式</td><td class="col4" colspan="2">见支付方式（way）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">biz_id</td><td class="col2" colspan="2">商户ID</td><td class="col4" colspan="2">见商户（biz_id）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">out_trade_no</td><td class="col2" colspan="2">外部订单号</td><td class="col4" colspan="2">见支付方式（way）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">out_refund_no</td><td class="col2" colspan="4">外部退款单号</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">reason</td><td class="col2" colspan="2">退款原因</td><td class="col4" colspan="2">长度限制255字节</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row11">
		<td class="col0" colspan="2">total_fee</td><td class="col2" colspan="2">支付总金额</td><td class="col4" colspan="2">大于退款金额，单位为分</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row12">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row13">
		<td class="col0" colspan="2">refund_fee</td><td class="col2" colspan="2">退款金额</td><td class="col4" colspan="2">大于0，单位为分</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row14">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row15">
		<td class="col0" colspan="2">user_id</td><td class="col2" colspan="4">用户ID</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row16">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row17">
		<td class="col0" colspan="2">user_name</td><td class="col2" colspan="4">用户名称</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row18">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row19">
		<td class="col0" colspan="2">pp_sign</td><td class="col2" colspan="2">签名</td><td class="col4" colspan="2">由业务方用私钥加密生成</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row20">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row21">
		<td class="col0" colspan="2">pp_sign_type</td><td class="col2" colspan="2">签名方式</td><td class="col4" colspan="2">暂时只能为RSA</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row22">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT83 TABLE [26810-27481] -->
</div>
<!-- EDIT81 SECTION "参数" [26723-27482] -->
<h3 class="sectionedit84" id="返回1">返回</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit85"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT85 TABLE [27514-27516] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit86"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">errno</td><td class="col2" colspan="2">错误码</td><td class="col4" colspan="2">见错误码（errno）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">message</td><td class="col2" colspan="2">错误描述</td><td class="col4" colspan="2">见错误描述（message）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">data</td><td class="col2" colspan="4">业务数据</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT86 TABLE [27571-27736] -->
<p>
成功时data字段说明
</p>

<p>
{| border=1
</p>
<div class="table sectionedit87"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT87 TABLE [27777-27779] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit88"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">refund_status</td><td class="col2" colspan="2">退款状态</td><td class="col4" colspan="2">见退款订单状态（refund_status）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">pp_sign</td><td class="col2" colspan="2">签名</td><td class="col4" colspan="2">由支付风头用私钥加密生成</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">pp_sign_type</td><td class="col2" colspan="2">签名方式</td><td class="col4" colspan="2">暂时只能为RSA</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT88 TABLE [27834-28061] -->
</div>
<!-- EDIT84 SECTION "返回" [27483-28062] -->
<h2 class="sectionedit89" id="退款异步通知">退款异步通知</h2>
<div class="level2">

<p>
退款状态有变动，会向指定的其他应用业务地址发异步通知，通知内容以POST方式发送。业务对异步通知验签通过并处理完毕后需返回success。参数都以POST方式传递，参数列表如下：
</p>

</div>
<!-- EDIT89 SECTION "退款异步通知" [28063-28333] -->
<h3 class="sectionedit90" id="历史3">历史</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit91"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT91 TABLE [28364-28366] -->
<p>
!版本!!日期!!作者!!内容
</p>
<div class="table sectionedit92"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">1</td><td class="col2" colspan="2">2015-09-12</td><td class="col4" colspan="2">徐典阳</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
</table></div>
<!-- EDIT92 TABLE [28399-28438] -->
</div>
<!-- EDIT90 SECTION "历史" [28334-28439] -->
<h3 class="sectionedit93" id="参数3">参数</h3>
<div class="level3">

<p>
paygw收到第三方异步通知后，参数都以POST方式传递，参数列表如下：
</p>

<p>
{| border=1
</p>
<div class="table sectionedit94"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT94 TABLE [28561-28563] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit95"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">notify_id</td><td class="col2" colspan="2">通知ID</td><td class="col4" colspan="2">通知唯一标示</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">notify_type</td><td class="col2" colspan="2">通知类型</td><td class="col4" colspan="2">退款异步通知为“refund_status_sync”</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">notify_time</td><td class="col2" colspan="2">通知时间</td><td class="col4" colspan="2">格式为【yyyy-MM-dd HH:mm:ss】 </td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">biz_id</td><td class="col2" colspan="2">商户ID</td><td class="col4" colspan="2">见商户（biz_id）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">way</td><td class="col2" colspan="2">支付方式</td><td class="col4" colspan="2">见支付方式（way）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row11">
		<td class="col0" colspan="2">trade_no</td><td class="col2" colspan="2">支付流水号</td><td class="col4" colspan="2">支付宝对应trade_no，微信对应transaction_id</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row12">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row13">
		<td class="col0" colspan="2">pay_time</td><td class="col2" colspan="2">支付时间</td><td class="col4" colspan="2">格式为【yyyy-MM-dd HH:mm:ss】</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row14">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row15">
		<td class="col0" colspan="2">out_trade_no</td><td class="col2" colspan="4">外部订单号</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row16">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row17">
		<td class="col0" colspan="2">out_refund_no</td><td class="col2" colspan="4">退款单号</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row18">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row19">
		<td class="col0" colspan="2">total_fee</td><td class="col2" colspan="2">支付金额</td><td class="col4" colspan="2">大于0，单位为分</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row20">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row21">
		<td class="col0" colspan="2">refund_fee</td><td class="col2" colspan="2">退款金额</td><td class="col4" colspan="2">大于0，单位为分</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row22">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row23">
		<td class="col0" colspan="2">refund_status</td><td class="col2" colspan="2">退款金额</td><td class="col4" colspan="2">见退款订单状态（refund_status）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row24">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row25">
		<td class="col0" colspan="2">user_id</td><td class="col2" colspan="4">用户ID</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row26">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row27">
		<td class="col0" colspan="2">user_name</td><td class="col2" colspan="4">用户名称</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row28">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row29">
		<td class="col0" colspan="2">pp_sign</td><td class="col2" colspan="2">签名</td><td class="col4" colspan="2">由业务方用私钥加密生成</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row30">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row31">
		<td class="col0" colspan="2">pp_sign_type</td><td class="col2" colspan="2">签名方式</td><td class="col4" colspan="2">暂时只能为RSA</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row32">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT95 TABLE [28618-29678] -->
</div>
<!-- EDIT93 SECTION "参数" [28440-29679] -->
<h2 class="sectionedit96" id="查询订单支付情况">查询订单支付情况</h2>
<div class="level2">

</div>
<!-- EDIT96 SECTION "查询订单支付情况" [29680-29717] -->
<h3 class="sectionedit97" id="历史4">历史</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit98"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT98 TABLE [29748-29750] -->
<p>
!版本!!日期!!作者!!内容
</p>
<div class="table sectionedit99"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">1</td><td class="col2" colspan="2">2015-09-12</td><td class="col4" colspan="2">徐典阳</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td>
	</tr>
</table></div>
<!-- EDIT99 TABLE [29783-29822] -->
</div>
<!-- EDIT97 SECTION "历史" [29718-29823] -->
<h3 class="sectionedit100" id="url2">URL</h3>
<div class="level3">

<p>
<a href="https://paygw.camera360.com/api/pay/query" class="urlextern" title="https://paygw.camera360.com/api/pay/query"  rel="nofollow">https://paygw.camera360.com/api/pay/query</a>
</p>

</div>
<!-- EDIT100 SECTION "URL" [29824-29880] -->
<h3 class="sectionedit101" id="参数4">参数</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit102"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT102 TABLE [29911-29913] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit103"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">way</td><td class="col2" colspan="2">支付方式</td><td class="col4" colspan="2">见支付方式（way）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">biz_id</td><td class="col2" colspan="2">商户ID</td><td class="col4" colspan="2">见商户（biz_id）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">out_trade_no</td><td class="col2" colspan="2">外部订单号</td><td class="col4" colspan="2">见支付方式（way）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">pp_sign</td><td class="col2" colspan="2">签名</td><td class="col4" colspan="2">由业务方用私钥加密生成</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">pp_sign_type</td><td class="col2" colspan="2">签名方式</td><td class="col4" colspan="2">暂时只能为RSA</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT103 TABLE [29968-30294] -->
</div>
<!-- EDIT101 SECTION "参数" [29881-30295] -->
<h3 class="sectionedit104" id="返回2">返回</h3>
<div class="level3">

<p>
{| border=1
</p>
<div class="table sectionedit105"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT105 TABLE [30326-30328] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit106"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">errno</td><td class="col2" colspan="2">错误码</td><td class="col4" colspan="2">见错误码（errno）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">message</td><td class="col2" colspan="2">错误描述</td><td class="col4" colspan="2">见错误描述（message）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">data</td><td class="col2" colspan="4">业务数据</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT106 TABLE [30383-30548] -->
<p>
查询成功时data字段说明
</p>

<p>
{| border=1
</p>
<div class="table sectionedit107"><table class="inline">
	<tr class="row0">
		
	</tr>
</table></div>
<!-- EDIT107 TABLE [30595-30597] -->
<p>
!字段!!含义!!说明!!类型!!是否为空!!默认
</p>
<div class="table sectionedit108"><table class="inline">
	<tr class="row0">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row1">
		<td class="col0" colspan="2">ret_code</td><td class="col2" colspan="2">查询返回码</td><td class="col4" colspan="2">0表示成功</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row2">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row3">
		<td class="col0" colspan="2">ret_msg</td><td class="col2" colspan="4">出错信息</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">是</td>
	</tr>
	<tr class="row4">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row5">
		<td class="col0" colspan="2">trade_status</td><td class="col2" colspan="2">订单状态</td><td class="col4" colspan="2">见支付订单状态（trade_status）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row6">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row7">
		<td class="col0" colspan="2">refund_status</td><td class="col2" colspan="2">订单退款状态</td><td class="col4" colspan="2">见支付订单退款状态（refund_status）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row8">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row9">
		<td class="col0" colspan="2">way</td><td class="col2" colspan="4">支付方式</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row10">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row11">
		<td class="col0" colspan="2">biz_id</td><td class="col2" colspan="2">商户ID</td><td class="col4" colspan="2">见商户（biz_id）</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row12">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row13">
		<td class="col0" colspan="2">out_trade_no</td><td class="col2" colspan="4">外部订单号</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row14">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row15">
		<td class="col0" colspan="2">trade_no</td><td class="col2" colspan="4">支付交易号</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row16">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row17">
		<td class="col0" colspan="2">total_fee</td><td class="col2" colspan="2">总金额</td><td class="col4" colspan="2">单位为分</td><td class="col6" colspan="2">int</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row18">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row19">
		<td class="col0" colspan="2">pp_sign</td><td class="col2" colspan="2">签名</td><td class="col4" colspan="2">由业务方用私钥加密生成</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row20">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
	<tr class="row21">
		<td class="col0" colspan="2">pp_sign_type</td><td class="col2" colspan="2">签名方式</td><td class="col4" colspan="2">暂时只能为RSA</td><td class="col6" colspan="2">string</td><td class="col8" colspan="2">否</td>
	</tr>
	<tr class="row22">
		<td class="col0"></td><td class="col1"></td><td class="col2"></td><td class="col3"></td><td class="col4"></td><td class="col5"></td><td class="col6"></td><td class="col7"></td><td class="col8"></td><td class="col9"></td>
	</tr>
</table></div>
<!-- EDIT108 TABLE [30652-31313] -->
</div>
<!-- EDIT104 SECTION "返回" [30296-] -->